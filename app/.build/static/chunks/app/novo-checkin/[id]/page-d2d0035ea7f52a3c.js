(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[728],{397:function(e,a,t){Promise.resolve().then(t.bind(t,3354))},3354:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var s=t(5444),r=t(9300),n=t(3135),d=t(2088),i=t(4693),c=t(8155),l=t(8382),o=t(1084),x=t(9047);function u(e){let{params:a}=e,t=(0,x.useRouter)(),[u,m]=(0,r.useState)(null),[h,p]=(0,r.useState)(""),[y,f]=(0,r.useState)(""),[g,j]=(0,r.useState)({}),[N,v]=(0,r.useState)(!1),[b,k]=(0,r.useState)(!0);(0,r.useEffect)(()=>{w()},[a.id]);let w=async()=>{try{let e=await fetch("/api/guests/".concat(a.id));if(e.ok){let a=await e.json();m(a)}else alert("Erro ao carregar dados do h\xf3spede"),t.push("/")}catch(e){console.error("Erro ao carregar h\xf3spede:",e),alert("Erro ao carregar dados do h\xf3spede"),t.push("/")}finally{k(!1)}},S=()=>{let e={};if(h||(e.dataEntrada="Data de entrada \xe9 obrigat\xf3ria"),y){if(h&&y){let a=new Date(h);new Date(y)<=a&&(e.dataSaida="Data de sa\xedda deve ser posterior \xe0 data de entrada")}}else e.dataSaida="Data de sa\xedda \xe9 obrigat\xf3ria";return j(e),0===Object.keys(e).length},E=async e=>{if(e.preventDefault(),S()){v(!0);try{let e=await fetch("/api/stays",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({guestId:a.id,dataEntrada:h,dataSaida:y,observacoes:"Nova estadia registrada"})});if(e.ok){let a=await e.json(),s=new URLSearchParams({guestName:u.nomeCompleto,stayId:a.id,dataEntrada:h,dataSaida:y});t.push("/confirmacao-checkin?".concat(s.toString()))}else{let a=await e.json();alert(a.error||"Erro ao realizar check-in. Tente novamente.")}}catch(e){console.error("Erro ao fazer check-in:",e),alert("Erro ao realizar check-in. Tente novamente.")}finally{v(!1)}}};return b?(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("div",{className:"text-lg text-gray-600",children:"Carregando dados do h\xf3spede..."})}):u?(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center space-y-4",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-800",children:[(0,s.jsx)(d.Z,{className:"inline-block mr-3 h-8 w-8 text-green-600"}),"Novo Check-in"]}),(0,s.jsx)("p",{className:"text-gray-600",children:"Registre uma nova estadia para este h\xf3spede"})]}),(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gray-50 rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,s.jsx)(i.Z,{className:"h-6 w-6 text-gray-600"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Dados do H\xf3spede"})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"Nome:"}),(0,s.jsx)("p",{className:"text-gray-800",children:u.nomeCompleto})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"CPF:"}),(0,s.jsx)("p",{className:"text-gray-800",children:u.cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"Email:"}),(0,s.jsx)("p",{className:"text-gray-800",children:u.email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"Telefone:"}),(0,s.jsx)("p",{className:"text-gray-800",children:u.telefone.replace(/(\d{2})(\d{4,5})(\d{4})/,"($1) $2-$3")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"Data de Nascimento:"}),(0,s.jsx)("p",{className:"text-gray-800",children:new Date(u.dataNascimento).toLocaleDateString("pt-BR")})]})]})]}),(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-lg p-8",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Novas Datas de Estadia"}),(0,s.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Entrada *"}),(0,s.jsx)("input",{type:"date",value:h,onChange:e=>{p(e.target.value),g.dataEntrada&&j(e=>({...e,dataEntrada:""}))},className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all ".concat(g.dataEntrada?"border-red-500":"border-gray-200")}),g.dataEntrada&&(0,s.jsx)("p",{className:"text-red-600 text-sm mt-1",children:g.dataEntrada})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Sa\xedda *"}),(0,s.jsx)("input",{type:"date",value:y,onChange:e=>{f(e.target.value),g.dataSaida&&j(e=>({...e,dataSaida:""}))},className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all ".concat(g.dataSaida?"border-red-500":"border-gray-200")}),g.dataSaida&&(0,s.jsx)("p",{className:"text-red-600 text-sm mt-1",children:g.dataSaida})]})]}),(0,s.jsxs)("div",{className:"flex space-x-4 pt-6",children:[(0,s.jsx)(o.default,{href:"/consultar",className:"flex-1",children:(0,s.jsxs)("button",{type:"button",className:"w-full border border-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-50 transition-colors font-semibold flex items-center justify-center space-x-2",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Cancelar"})]})}),(0,s.jsxs)("button",{type:"submit",disabled:N,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-lg hover:from-green-600 hover:to-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all font-semibold flex items-center justify-center space-x-2",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:N?"Processando...":"CONFIRMAR CHECK-IN"})]})]})]})]})]}):(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("div",{className:"text-lg text-gray-600",children:"H\xf3spede n\xe3o encontrado"})})}},8155:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(2154).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8382:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(2154).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},2088:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(2154).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},4693:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(2154).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9047:function(e,a,t){"use strict";var s=t(1206);t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[337,84,386,156,744],function(){return e(e.s=397)}),_N_E=e.O()}]);