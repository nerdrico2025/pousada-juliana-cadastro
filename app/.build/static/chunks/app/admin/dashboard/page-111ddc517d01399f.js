(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{7567:function(e,t,s){Promise.resolve().then(s.bind(s,4044))},4044:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(5444),l=s(9300),i=s(3135),r=s(4624),c=s(2154);let n=(0,c.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var d=s(5076);let o=(0,c.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var x=s(8082),m=s(1069),h=s(2088),p=s(9047),u=s(1084);function y(){let e=(0,p.useRouter)(),[t,s]=(0,l.useState)(null),[c,y]=(0,l.useState)([]),[j,g]=(0,l.useState)([]),[f,N]=(0,l.useState)(""),[b,v]=(0,l.useState)(null),[w,k]=(0,l.useState)(!0),[E,C]=(0,l.useState)(!1);(0,l.useEffect)(()=>{S()},[]),(0,l.useEffect)(()=>{t&&Z()},[t]),(0,l.useEffect)(()=>{L()},[f,c]);let S=async()=>{try{let t=await fetch("/api/auth/verify");if(t.ok){let e=await t.json();s(e.admin)}else e.push("/admin")}catch(t){e.push("/admin")}finally{k(!1)}},Z=async()=>{try{let e=await fetch("/api/guests");if(e.ok){let t=await e.json();y(t)}}catch(e){console.error("Erro ao carregar h\xf3spedes:",e)}},L=()=>{f.trim()?g(c.filter(e=>e.nomeCompleto.toLowerCase().includes(f.toLowerCase())||e.email.toLowerCase().includes(f.toLowerCase())||e.cpf.includes(f.replace(/\D/g,"")))):g(c)},D=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),e.push("/admin")}catch(e){console.error("Erro no logout:",e)}},M=async()=>{C(!0);try{let e=await fetch("/api/guests/export");if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="hospedes-pousada-juliana-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),document.body.removeChild(a)}else alert("Erro ao exportar dados")}catch(e){console.error("Erro na exporta\xe7\xe3o:",e),alert("Erro ao exportar dados")}finally{C(!1)}},R=e=>new Date(e).toLocaleDateString("pt-BR"),H=e=>e.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),P=e=>e.replace(/(\d{2})(\d{4,5})(\d{4})/,"($1) $2-$3");return w?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("div",{className:"text-lg text-gray-600",children:"Carregando..."})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-800",children:[(0,a.jsx)(r.Z,{className:"inline-block mr-3 h-8 w-8 text-red-600"}),"Dashboard Administrativo"]}),(0,a.jsxs)("p",{className:"text-gray-600 mt-1",children:["Bem-vindo, ",null==t?void 0:t.login]})]}),(0,a.jsxs)("button",{onClick:D,className:"flex items-center space-x-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[(0,a.jsx)(n,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Sair"})]})]}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total de H\xf3spedes"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:c.length})]}),(0,a.jsx)(r.Z,{className:"h-8 w-8 text-blue-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Resultados da Busca"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:j.length})]}),(0,a.jsx)(d.Z,{className:"h-8 w-8 text-green-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6",children:(0,a.jsxs)("button",{onClick:M,disabled:E,className:"w-full flex items-center justify-center space-x-2 bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-semibold",children:[(0,a.jsx)(o,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:E?"Exportando...":"Exportar CSV"})]})})]}),(0,a.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-md p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por nome, email ou CPF...",value:f,onChange:e=>N(e.target.value),className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none"})]})}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-md overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["Lista de H\xf3spedes (",j.length,")"]})}),(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"H\xf3spede"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xdaLTIMA ESTADIA"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cadastro"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map((e,t)=>(0,a.jsxs)(i.E.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.nomeCompleto}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:H(e.cpf)})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.email}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:P(e.telefone)})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{children:e.lastStay?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:[R(e.lastStay.dataEntrada)," a ",R(e.lastStay.dataSaida)]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Status: ",e.lastStay.status," â€¢ Total: ",e.totalStays," estadia",1!==e.totalStays?"s":""]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Nenhuma estadia registrada"}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:["Nascimento: ",R(e.dataNascimento)]})]})})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R(e.dataCadastro)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>v(e),className:"text-blue-600 hover:text-blue-900 p-1",title:"Ver detalhes",children:(0,a.jsx)(x.Z,{className:"h-4 w-4"})}),(0,a.jsx)(u.default,{href:"/editar/".concat(e.id),children:(0,a.jsx)("button",{className:"text-yellow-600 hover:text-yellow-900 p-1",title:"Editar",children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(u.default,{href:"/novo-checkin/".concat(e.id),children:(0,a.jsx)("button",{className:"text-green-600 hover:text-green-900 p-1",title:"Novo check-in",children:(0,a.jsx)(h.Z,{className:"h-4 w-4"})})})]})})]},e.id))})]}),0===j.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(r.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:f?"Nenhum h\xf3spede encontrado para esta busca":"Nenhum h\xf3spede cadastrado"})]})]})]}),b&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:()=>v(null),children:(0,a.jsx)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-800",children:"Detalhes do H\xf3spede"}),(0,a.jsx)("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Nome Completo"}),(0,a.jsx)("p",{className:"text-gray-800 font-semibold",children:b.nomeCompleto})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"CPF"}),(0,a.jsx)("p",{className:"text-gray-800",children:H(b.cpf)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Email"}),(0,a.jsx)("p",{className:"text-gray-800",children:b.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Telefone"}),(0,a.jsx)("p",{className:"text-gray-800",children:P(b.telefone)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Data de Nascimento"}),(0,a.jsx)("p",{className:"text-gray-800",children:R(b.dataNascimento)})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Data de Cadastro"}),(0,a.jsx)("p",{className:"text-gray-800",children:R(b.dataCadastro)})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Hist\xf3rico de Estadias (",b.totalStays,")"]}),b.stays.length>0?(0,a.jsx)("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:b.stays.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-800",children:["Estadia #",b.stays.length-t]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("ativo"===e.status?"bg-green-100 text-green-800":"finalizado"===e.status?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:e.status})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Entrada:"}),(0,a.jsx)("p",{className:"font-medium text-green-600",children:R(e.dataEntrada)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Sa\xedda:"}),(0,a.jsx)("p",{className:"font-medium text-red-600",children:R(e.dataSaida)})]})]}),e.observacoes&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("span",{className:"text-gray-600 text-sm",children:"Observa\xe7\xf5es:"}),(0,a.jsx)("p",{className:"text-sm text-gray-800",children:e.observacoes})]})]},e.id))}):(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma estadia registrada"})]}),(0,a.jsxs)("div",{className:"flex space-x-4 pt-6 border-t",children:[(0,a.jsx)(u.default,{href:"/editar/".concat(b.id),className:"flex-1",children:(0,a.jsxs)("button",{className:"w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold flex items-center justify-center space-x-2",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Editar Dados"})]})}),(0,a.jsx)(u.default,{href:"/novo-checkin/".concat(b.id),className:"flex-1",children:(0,a.jsxs)("button",{className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors font-semibold flex items-center justify-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Novo Check-in"})]})})]})]})]})})})]})}},8082:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(2154).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1069:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(2154).Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]])},5076:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(2154).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2088:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(2154).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},4624:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(2154).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9047:function(e,t,s){"use strict";var a=s(1206);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[337,84,386,156,744],function(){return e(e.s=7567)}),_N_E=e.O()}]);