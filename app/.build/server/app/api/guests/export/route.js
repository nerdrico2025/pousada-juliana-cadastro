"use strict";(()=>{var e={};e.id=328,e.ids=[328],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7094:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>x});var r={};a.r(r),a.d(r,{GET:()=>l,dynamic:()=>p});var o=a(9182),s=a(2007),n=a(6719),i=a(3442),d=a(3524);let p="force-dynamic",u=new d.PrismaClient;async function l(){try{let e=await u.guest.findMany({include:{stays:{orderBy:{createdAt:"desc"}}},orderBy:{dataCadastro:"desc"}}),t=e=>e.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),a=e=>e.replace(/(\d{2})(\d{4,5})(\d{4})/,"($1) $2-$3"),r=e=>e.toLocaleDateString("pt-BR"),o=["ID,Nome Completo,CPF,Email,Telefone,Data de Nascimento,Data de Cadastro,Total de Estadias,\xdaltima Data de Entrada,\xdaltima Data de Sa\xedda,Status da \xdaltima Estadia",...e.map(e=>{let o=e.stays[0]||null;return[e.id,`"${e.nomeCompleto}"`,t(e.cpf),e.email,a(e.telefone),r(e.dataNascimento),r(e.dataCadastro),e.stays.length,o?r(o.dataEntrada):"N/A",o?r(o.dataSaida):"N/A",o?o.status:"N/A"].join(",")})].join("\n");return new i.NextResponse("\uFEFF"+o,{status:200,headers:{"Content-Type":"text/csv; charset=utf-8","Content-Disposition":`attachment; filename=hospedes-pousada-juliana-${new Date().toISOString().split("T")[0]}.csv`}})}catch(e){return console.error("Erro ao exportar CSV:",e),i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/guests/export/route",pathname:"/api/guests/export",filename:"route",bundlePath:"app/api/guests/export/route"},resolvedPagePath:"/home/ubuntu/pousada-juliana/app/app/api/guests/export/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:g}=c,h="/api/guests/export/route";function y(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:x})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[372,609],()=>a(7094));module.exports=r})();